#!/usr/bin/env python3
"""
Git Hook for Jira Ticket Management
Install this as a post-checkout and post-commit hook to automatically update Jira tickets.
"""

import os
import sys
from pathlib import Path

# Get the directory containing this script
SCRIPT_DIR = Path(__file__).parent.absolute()

# Import the ticket manager
sys.path.insert(0, str(SCRIPT_DIR.parent))

try:
    from jira_ticket_manager import JiraTicketManager
    
    def update_ticket():
        """Update Jira ticket based on current git state."""
        manager = JiraTicketManager()
        
        if not manager.validate_credentials():
            # Don't fail the git operation if Jira is unavailable
            print("Warning: Could not connect to Jira")
            return
        
        # Try to update the ticket
        manager.auto_update_ticket()
    
    if __name__ == "__main__":
        update_ticket()
        
except Exception as e:
    # Don't fail git operations if there's an error
    print(f"Warning: Jira ticket update failed: {e}")
    pass
